# Phaseë³„ ì§„í–‰ ìƒí™© ğŸ“Š

OnVoice COM ë¸Œë¦¬ì§€ ê°œë°œ ì§„í–‰ ìƒí™© ìš”ì•½

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-11-18 (Day 3 ì™„ë£Œ)

---

## ğŸ¯ ì „ì²´ ì§„í–‰ë¥ 

```
[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 70% (18h / 50h)

Week 0: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (6h)   âœ… ì™„ë£Œ
Week 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (8h)   âœ… ì™„ë£Œ â­
Week 2: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0% (0h)     ğŸ“‹ ê³„íš
Week 3: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0% (0h)     ğŸ“‹ ê³„íš
```

---

## â±ï¸ ì „ì²´ íƒ€ì„ë¼ì¸

| ì£¼ì°¨   | ì‹œê°„ ë²”ìœ„ | ì£¼ìš” ë§ˆì¼ìŠ¤í†¤          | ìƒíƒœ               |
| ------ | --------- | ---------------------- | ------------------ |
| Week 0 | T+0-6h    | **PoC ì™„ì„±** â­        | âœ… ì™„ë£Œ (6h)       |
| Week 1 | T+6-20h   | **COM ë¸Œë¦¬ì§€ ê¸°ì´ˆ** ğŸ”„ | ì§„í–‰ ì¤‘ (8h / 14h) |
| Week 2 | T+20-40h  | Electron ì—°ë™          | ğŸ“‹ ê³„íš            |
| Week 3 | T+40-50h  | í…ŒìŠ¤íŠ¸ ë° ì•ˆì •í™”       | ğŸ“‹ ê³„íš            |

**ì¤‘ìš” ë³€ê²½ì‚¬í•­**:

- âœ¨ ProcessLoopbackCapture ë ˆí¬ ë°œê²¬ìœ¼ë¡œ **PoC ë‹¨ê³„ ì¶”ê°€**
- â° Phase 3-6 (WASAPI ì§ì ‘ êµ¬í˜„) â†’ **PoCë¡œ ëŒ€ì²´**
- ğŸ“‰ ì˜ˆìƒ ê°œë°œ ì‹œê°„: 60ì‹œê°„ â†’ **50ì‹œê°„** (10ì‹œê°„ ë‹¨ì¶•!)

---

## ğŸ“Š í˜„ì¬ ìƒíƒœ (Week 1 ì™„ë£Œ)

### âœ… ì™„ë£Œí•œ Phase

| Phase       | ë‚´ìš©                        | ì‹œê°„   | ìƒíƒœ |
| ----------- | --------------------------- | ------ | ---- |
| **Week 0**  | PoC ê°œë°œ                    | 6h     | âœ…   |
| Phase 1     | VS 2026 + ATL ì„¤ì •          | 1h     | âœ…   |
| Phase 2     | C++ ê¸°ì´ˆ í•™ìŠµ               | 1.5h   | âœ…   |
| Phase 3.1   | WASAPI ê¸°ë³¸ ìº¡ì²˜            | 1.5h   | âœ…   |
| Phase 4     | PID ê¸°ë°˜ ìº¡ì²˜               | 2h     | âœ…   |
| **Phase 7** | **ATL COM DLL í”„ë¡œì íŠ¸** â­ | **2h** | âœ…   |
| **Phase 8** | **COM ì´ë²¤íŠ¸ ì½œë°±** â­      | **2h** | âœ…   |
| **Phase 9** | **ìº¡ì²˜ ì—”ì§„ í†µí•©** â­       | **2h** | âœ…   |

### â³ ì§„í–‰ ì˜ˆì • (Week 2)

| Phase       | ë‚´ìš©          | ì˜ˆìƒ ì‹œê°„ | ë‚œì´ë„   |
| ----------- | ------------- | --------- | -------- |
| Phase 10-12 | Electron ì—°ë™ | 18-22h    | â­â­â­â­ |

---

## ğŸ‰ ì£¼ìš” ì„±ê³¼

### Week 0 (2025-11-16)

- âœ… PID ê¸°ë°˜ ì˜¤ë””ì˜¤ ìº¡ì²˜ ê²€ì¦ ì™„ë£Œ
- âœ… í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ (Discord/Chrome)
- âœ… 16kHz ìë™ ë³€í™˜ í™•ì¸ (SpeexDSP ë¶ˆí•„ìš”)

### Day 1 (2025-11-17)

- âœ… Visual Studio 2026 + ATL í™˜ê²½ êµ¬ì¶•
- âœ… C++ í¬ì¸í„°/ì°¸ì¡° í•™ìŠµ ì™„ë£Œ
- âœ… COM ê¸°ë³¸ ê°œë… ìŠµë“
- âœ… WASAPI ë£¨í”„ë°± ìº¡ì²˜ ì„±ê³µ (48kHz, 240K í”„ë ˆì„)

### Day 2 (2025-11-18)

- âœ… **PID ê¸°ë°˜ ìº¡ì²˜ ì„±ê³µ** (ê°€ì¥ ì–´ë ¤ìš´ ë‹¨ê³„!)
- âœ… `ActivateAudioInterfaceAsync` ë¹„ë™ê¸° API êµ¬í˜„
- âœ… `IActivateAudioInterfaceCompletionHandler` ì™„ë£Œ í•¸ë“¤ëŸ¬
- âœ… `IAgileObject`ë¡œ MTA ì•ˆì •ì„± í™•ë³´
- âœ… Chrome PID (21616) ì„ íƒì  ìº¡ì²˜ ê²€ì¦
- âœ… ì°¸ì¡° ì¹´ìš´íŒ… ì •ìƒ (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì œë¡œ)

### Day 3-4 (2025-11-18) â­ ì‹ ê·œ!

- âœ… **Phase 7: ATL COM DLL í”„ë¡œì íŠ¸ êµ¬ì¡° ì™„ì„±**
- âœ… OnVoiceAudioBridge í”„ë¡œì íŠ¸ ìƒì„±
- âœ… `IOnVoiceCapture` ì¸í„°í˜ì´ìŠ¤ 3ê°œ ë©”ì„œë“œ êµ¬í˜„
- âœ… `StartCapture(PID)` / `StopCapture()` / `GetCaptureState()` ì‘ë™
- âœ… ìƒíƒœ ê´€ë¦¬ ê°œì„  (CaptureState enum)

- âœ… **Phase 8: COM ì´ë²¤íŠ¸ ì½œë°± ì™„ì„±**
- âœ… `_IOnVoiceCaptureEvents` ì¸í„°í˜ì´ìŠ¤ ì •ì˜
- âœ… `IConnectionPoint` / `IConnectionPointContainer` êµ¬í˜„
- âœ… GIT í”„ë¡ì‹œë¥¼ í†µí•œ ìŠ¤ë ˆë“œ ê°„ ì•ˆì „í•œ ì´ë²¤íŠ¸ ì „ì†¡
- âœ… `Fire_OnAudioData()` í—¬í¼ í•¨ìˆ˜ êµ¬í˜„

- âœ… **Phase 9: ìº¡ì²˜ ì—”ì§„ í†µí•©**
- âœ… `AudioCaptureEngine` í´ë˜ìŠ¤ êµ¬í˜„
- âœ… `ProcessLoopbackCapture` ë˜í•‘
- âœ… ì‹¤ì œ WASAPI ìº¡ì²˜ í†µí•©
- âœ… 16kHz mono PCM ìë™ ë³€í™˜

- âœ… **VBScript ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸ ì„±ê³µ**
  - COM ê°ì²´ ìƒì„± ë° ì´ë²¤íŠ¸ ì—°ê²° ì„±ê³µ
  - ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ ë°ì´í„° ìˆ˜ì‹  í™•ì¸
  - ìƒíƒœ ì „í™˜ í™•ì¸ (Stopped â†’ Starting â†’ Capturing â†’ Stopped)

**ê²€ì¦ ê²°ê³¼**:

```
âœ… CreateObject("OnVoiceAudioBridge.OnVoiceCapture", "OnVoice_") ì„±ê³µ
âœ… StartCapture(PID) â†’ ì‹¤ì œ ì˜¤ë””ì˜¤ ìº¡ì²˜ ì‹œì‘
âœ… OnVoice_OnAudioData ì´ë²¤íŠ¸ ìˆ˜ì‹  ì„±ê³µ
âœ… 16kHz mono PCM ë°ì´í„° ì‹¤ì‹œê°„ ì „ì†¡ í™•ì¸
âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!
```

---

## ğŸ“ˆ ì‹œê°„ íš¨ìœ¨

| í•­ëª©             | ê³„íš | ì‹¤ì œ | ì°¨ì´         |
| ---------------- | ---- | ---- | ------------ |
| Week 0           | 14h  | 6h   | **-8h** âœ¨   |
| Week 1 (Day 1)   | 6h   | 4h   | **-2h** âœ¨   |
| Week 1 (Day 2)   | 8h   | 2h   | **-6h** âœ¨   |
| Week 1 (Day 3-4) | 11h  | 6h   | **-5h** âœ¨   |
| **ëˆ„ì  ì ˆê°**    | 39h  | 18h  | **-21h** ğŸ‰  |
| **ë‚¨ì€ ì˜ˆì‚°**    | 50h  | 32h  | -            |
| **íš¨ìœ¨ì„±**       | -    | -    | **54% í–¥ìƒ** |

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„ (Week 2)

### Phase 10-12: Electron ì—°ë™ (ìµœìš°ì„ ) â­

**ëª©í‘œ**: COM DLL â†’ Electron Main â†’ Renderer ì‹¤ì‹œê°„ ì „ì†¡

**ì˜ˆìƒ ì†Œìš”**: 18-22ì‹œê°„  
**ë‚œì´ë„**: â­â­â­â­ ë§¤ìš° ì–´ë ¤ì›€

**í•µì‹¬ ì‘ì—…**:

1. winax ì„¤ì¹˜ ë° ì¬ë¹Œë“œ
2. Electron Main í”„ë¡œì„¸ìŠ¤ì—ì„œ COM ê°ì²´ ìƒì„±
3. ì´ë²¤íŠ¸ ìˆ˜ì‹  ë° Rendererë¡œ ì „ì†¡
4. IPC í†µì‹  êµ¬í˜„
5. E2E í…ŒìŠ¤íŠ¸

**í…ŒìŠ¤íŠ¸ ëª©í‘œ**:

```javascript
// Electron Main í”„ë¡œì„¸ìŠ¤
const winax = require("winax");
const capture = new winax.Object("OnVoiceAudioBridge.OnVoiceCapture");

capture.OnAudioData = (audioData) => {
  mainWindow.webContents.send("audio-data", audioData);
};

capture.StartCapture(discordPid);
```

---

## ğŸ“š ìƒì„¸ ë¬¸ì„œ

ê° ì£¼ì°¨ë³„ ìƒì„¸ ë‚´ìš©ì€ ë‹¤ìŒ ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”:

- **[Week 0: PoC ì™„ì„±](phases/week0-poc.md)** (6h, ì™„ë£Œ)
- **[Week 1: COM ë¸Œë¦¬ì§€ ê¸°ì´ˆ](phases/week1-com-bridge.md)** (8h / 14h, ì§„í–‰ ì¤‘) â­
- **[Week 2: Electron ì—°ë™](phases/week2-electron.md)** (ê³„íš)
- **[Week 3: í…ŒìŠ¤íŠ¸ ë° ì•ˆì •í™”](phases/week3-testing.md)** (ê³„íš)

---

## ğŸ“‹ ë§ˆì¼ìŠ¤í†¤

| ë§ˆì¼ìŠ¤í†¤              | ìƒíƒœ        | ë‚ ì§œ           | ë¹„ê³              |
| --------------------- | ----------- | -------------- | ---------------- |
| Week 0 PoC ì™„ì„±       | âœ… ì™„ë£Œ     | 2025-11-16     | PID ìº¡ì²˜ ê²€ì¦    |
| Day 1 í•™ìŠµ ì™„ë£Œ       | âœ… ì™„ë£Œ     | 2025-11-17     | C++/COM/WASAPI   |
| Day 2 PID ìº¡ì²˜        | âœ… ì™„ë£Œ     | 2025-11-18     | ë¹„ë™ê¸° API       |
| **Week 1 COM ë¸Œë¦¬ì§€** | âœ… **ì™„ë£Œ** | **2025-11-18** | **ì „ì²´ í†µí•©** â­ |
| Week 2 Electron ì—°ë™  | ğŸ“… ì˜ˆì •     | 2025-11-27     | winax            |
| Week 3 MVP ì™„ì„±       | ğŸ“… ì˜ˆì •     | 2025-12-04     | E2E í…ŒìŠ¤íŠ¸       |

---

## ğŸ“ ë¬¸ì„œ êµ¬ì¡°

```
docs/
â”œâ”€â”€ phase-progress.md              â† ì§€ê¸ˆ ì—¬ê¸° (ì „ì²´ ìš”ì•½)
â”œâ”€â”€ phases/
â”‚   â”œâ”€â”€ week0-poc.md              (Phase 0-0.8)
â”‚   â”œâ”€â”€ week1-com-bridge.md       (Phase 1-9) â­ ìì£¼ ì—…ë°ì´íŠ¸
â”‚   â”œâ”€â”€ week2-electron.md         (Phase 10-13)
â”‚   â””â”€â”€ week3-testing.md          (Phase 14-15)
â”œâ”€â”€ learning-notes.md
â”œâ”€â”€ details/
â”‚   â”œâ”€â”€ com-deep-dive.md
â”‚   â”œâ”€â”€ wasapi-deep-dive.md
â”‚   â””â”€â”€ poc-lessons.md
â””â”€â”€ build-errors.md
```

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-11-18 (Week 1 ì™„ë£Œ)  
**í˜„ì¬ í¬ì»¤ìŠ¤**: Week 2 (Electron ì—°ë™)  
**ë‹¤ìŒ ë§ˆì¼ìŠ¤í†¤**: Week 2 ì‹œì‘ (2025-11-19)
