# Phaseë³„ ì§„í–‰ ìƒí™© ğŸ“Š

60ì‹œê°„ ìŠ¤í”„ë¦°íŠ¸ì˜ ê° Phaseë³„ ìƒì„¸ ì§„í–‰ ê¸°ë¡

---

## â±ï¸ ì „ì²´ íƒ€ì„ë¼ì¸ (ìˆ˜ì •ë¨)

| ì£¼ì°¨   | ì‹œê°„ ë²”ìœ„ | ì£¼ìš” ë§ˆì¼ìŠ¤í†¤    | ìƒíƒœ    |
| ------ | --------- | ---------------- | ------- |
| Week 0 | T+0-6h    | **PoC ì™„ì„±** â­  | âœ… ì™„ë£Œ |
| Week 1 | T+6-20h   | COM ë¸Œë¦¬ì§€ ê¸°ì´ˆ  | ğŸ“‹ ê³„íš |
| Week 2 | T+20-40h  | Electron ì—°ë™    | ğŸ“‹ ê³„íš |
| Week 3 | T+40-50h  | í…ŒìŠ¤íŠ¸ ë° ì•ˆì •í™” | ğŸ“‹ ê³„íš |

**ì¤‘ìš” ë³€ê²½ì‚¬í•­**:

- âœ¨ ProcessLoopbackCapture ë ˆí¬ ë°œê²¬ìœ¼ë¡œ **PoC ë‹¨ê³„ ì¶”ê°€**
- â° Phase 3-6 (WASAPI ì§ì ‘ êµ¬í˜„) â†’ **PoCë¡œ ëŒ€ì²´**
- ğŸ“‰ ì˜ˆìƒ ê°œë°œ ì‹œê°„: 60ì‹œê°„ â†’ **50ì‹œê°„** (10ì‹œê°„ ë‹¨ì¶•!)

---

## Week 0: PoC ì™„ì„± ë° ê²€ì¦ âœ…

### Phase 0: í”„ë¡œì íŠ¸ ì´ˆê¸°í™” (ì™„ë£Œ)

- **ì‹œê°„**: T+0h
- **ë‚œì´ë„**: â­ ì‰¬ì›€
- **ëª©í‘œ**: GitHub ë ˆí¬ ìƒì„±, ë¬¸ì„œ êµ¬ì¡° ì„¸íŒ…
- **ì™„ë£Œ ë‚ ì§œ**: 2025-11-16
- **ì‹¤ì œ ì†Œìš” ì‹œê°„**: 0.5ì‹œê°„

**ì²´í¬í¬ì¸íŠ¸**:

- [x] GitHub ë ˆí¬ ìƒì„± (onvoice-com-bridge)
- [x] .gitignore ì„¤ì • (VisualStudio + ì»¤ìŠ¤í…€)
- [x] README.md ì‘ì„±
- [x] docs í´ë” êµ¬ì¡° ìƒì„±
- [x] learning-notes.md í…œí”Œë¦¿
- [x] build-errors.md í…œí”Œë¦¿
- [x] phase-progress.md í…œí”Œë¦¿
- [x] ì²« ì»¤ë°‹ ì™„ë£Œ

**í•™ìŠµ ë‚´ìš©**:

- Git ì›Œí¬í”Œë¡œìš° ì„¤ê³„
- í”„ë¡œì íŠ¸ ë¬¸ì„œí™” ì „ëµ
- í•™ìŠµ ë…¸íŠ¸ ì‹œìŠ¤í…œ êµ¬ì¶•

---

### Phase 0.5: COM ê¸°ì´ˆ ê°œë… í•™ìŠµ (ì™„ë£Œ)

- **ì‹œê°„**: T+0.5-2h
- **ë‚œì´ë„**: â­â­ ë³´í†µ
- **ëª©í‘œ**: COM í•µì‹¬ ê°œë… ì´í•´
- **ì™„ë£Œ ë‚ ì§œ**: 2025-11-16
- **ì‹¤ì œ ì†Œìš” ì‹œê°„**: 1.5ì‹œê°„

**ì²´í¬í¬ì¸íŠ¸**:

- [x] COMì´ë€ ë¬´ì—‡ì¸ê°€ í•™ìŠµ
- [x] IUnknown 3ê°€ì§€ ë©”ì„œë“œ ì´í•´
- [x] HRESULT ì—ëŸ¬ ì½”ë“œ ì²´ê³„
- [x] CoInitialize/CoUninitialize
- [x] ì°¸ì¡° ì¹´ìš´íŒ… (AddRef/Release)
- [x] learning-notes.mdì— ìƒì„¸ ì •ë¦¬

**í•™ìŠµ ë‚´ìš©**:

```markdown
í•µì‹¬ ê°œë… 5ê°€ì§€:

1. IUnknown (QueryInterface, AddRef, Release)
2. HRESULT (ì—ëŸ¬ ì½”ë“œ ë° ì²´í¬ ë§¤í¬ë¡œ)
3. CoInitialize/CoUninitialize (COM ì´ˆê¸°í™”)
4. CoCreateInstance (COM ê°ì²´ ìƒì„±)
5. ì°¸ì¡° ì¹´ìš´íŒ… (ë©”ëª¨ë¦¬ ê´€ë¦¬)

ì‹¤ìƒí™œ ë¹„ìœ :

- COM = ì•„íŒŒíŠ¸ ê´€ë¦¬ ê·œì¹™
- IUnknown = ëª¨ë“  COM ê°ì²´ì˜ DNA
- ì°¸ì¡° ì¹´ìš´íŒ… = ë„ì„œê´€ ê³µìœ  ì±… ì‹œìŠ¤í…œ
```

**ë°°ìš´ ì **:

- âœ… COMì€ ì–¸ì–´ ê°„ í†µì‹  í‘œì¤€
- âœ… ì°¸ì¡° ì¹´ìš´íŒ…ìœ¼ë¡œ ìë™ ë©”ëª¨ë¦¬ ê´€ë¦¬
- âœ… OnVoiceì—ì„œ C++ DLL â†” Electron ì—°ê²°ì— í•„ìˆ˜

---

### Phase 0.6: WASAPI ê°œë… í•™ìŠµ (ì™„ë£Œ)

- **ì‹œê°„**: T+2-3h
- **ë‚œì´ë„**: â­â­ ë³´í†µ
- **ëª©í‘œ**: WASAPI ì•„í‚¤í…ì²˜ ë° Loopback Capture ì´í•´
- **ì™„ë£Œ ë‚ ì§œ**: 2025-11-16
- **ì‹¤ì œ ì†Œìš” ì‹œê°„**: 1ì‹œê°„

**ì²´í¬í¬ì¸íŠ¸**:

- [x] WASAPI ì•„í‚¤í…ì²˜ ì´í•´
- [x] Loopback Capture vs ì¼ë°˜ Capture
- [x] Process-Specific Loopback ì›ë¦¬
- [x] WASAPI ì´ˆê¸°í™” 6ë‹¨ê³„ íë¦„
- [x] ìº¡ì²˜ ë£¨í”„ íŒ¨í„´ (GetBuffer/ReleaseBuffer)
- [x] learning-notes.mdì— ìƒì„¸ ì •ë¦¬

**í•™ìŠµ ë‚´ìš©**:

```markdown
í•µì‹¬ ì»´í¬ë„ŒíŠ¸ 4ê°€ì§€:

1. IMMDeviceEnumerator (ë””ë°”ì´ìŠ¤ ëª©ë¡)
2. IMMDevice (íŠ¹ì • ë””ë°”ì´ìŠ¤)
3. IAudioClient (ì˜¤ë””ì˜¤ ì„¸ì…˜)
4. IAudioCaptureClient (ì‹¤ì œ ë°ì´í„°)

Process-Specific Loopback:

- ì¼ë°˜ Loopback: ì‹œìŠ¤í…œ ì „ì²´ ì˜¤ë””ì˜¤
- Process Loopback: íŠ¹ì • ì•±ë§Œ (Discord/Chrome)
- êµ¬ì¡°ì²´: AUDIOCLIENT_PROCESS_LOOPBACK_PARAMS
```

**ë°°ìš´ ì **:

- âœ… WASAPI = ì €ìˆ˜ì¤€ ì˜¤ë””ì˜¤ API (ë‚®ì€ ì§€ì—°)
- âœ… Loopback = ìŠ¤í”¼ì»¤ ì¶œë ¥ ìº¡ì²˜
- âœ… PID ê¸°ë°˜ìœ¼ë¡œ ì•±ë³„ ì˜¤ë””ì˜¤ ê²©ë¦¬ ê°€ëŠ¥
- âœ… 16kHz ë³€í™˜ì´ Windows ì—”ì§„ì—ì„œ ìë™ ì²˜ë¦¬ë¨ (SpeexDSP ë¶ˆí•„ìš”!)

---

### Phase 0.7: ProcessLoopbackCapture ì½”ë“œ ë¦¬ë·° (ì™„ë£Œ)

- **ì‹œê°„**: T+3-4h
- **ë‚œì´ë„**: â­â­â­ ì–´ë ¤ì›€
- **ëª©í‘œ**: ë ˆí¼ëŸ°ìŠ¤ ì½”ë“œ ë¶„ì„ ë° íŒ¨í„´ í•™ìŠµ
- **ì™„ë£Œ ë‚ ì§œ**: 2025-11-16
- **ì‹¤ì œ ì†Œìš” ì‹œê°„**: 1ì‹œê°„

**ì²´í¬í¬ì¸íŠ¸**:

- [x] ProcessLoopbackCapture.h ë¶„ì„
- [x] ì—ëŸ¬ ì½”ë“œ enum ì´í•´
- [x] ì½œë°± í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ íŒŒì•…
- [x] í´ë˜ìŠ¤ ë©¤ë²„ ë³€ìˆ˜ ë¶„ì„
- [x] Public/Private API ë©”ì„œë“œ íŒŒì•…
- [x] ProcessLoopbackCapture.cpp í•µì‹¬ ë¡œì§ ë¶„ì„
- [x] StartCapture() êµ¬í˜„ ì´í•´
- [x] ActivateAudioInterface() ë¹„ë™ê¸° íŒ¨í„´ í•™ìŠµ
- [x] CaptureThreadProc() ìº¡ì²˜ ë£¨í”„ ë¶„ì„
- [x] learning-notes.mdì— íŒ¨í„´ ì •ë¦¬

**ë°œê²¬í•œ í•µì‹¬ íŒ¨í„´ 5ê°€ì§€**:

**1. ë¹„ë™ê¸° í™œì„±í™” íŒ¨í„´**

```cpp
// Completion Handler í´ë˜ìŠ¤
class ActivateCompletionHandler :
    public IActivateAudioInterfaceCompletionHandler
{
    HRESULT ActivateCompleted(...) {
        // ì‘ì—… ì™„ë£Œ í›„ ì´ë²¤íŠ¸ ì‹ í˜¸
        SetEvent(m_hEvent);
    }
};

// ì‚¬ìš©
ActivateAudioInterfaceAsync(..., pHandler, ...);
WaitForSingleObject(pHandler->m_hEvent, INFINITE);
```

**2. ìº¡ì²˜ ìŠ¤ë ˆë“œ íŒ¨í„´**

```cpp
// Static í•¨ìˆ˜ + this í¬ì¸í„° ì „ë‹¬
static DWORD WINAPI CaptureThreadProc(LPVOID param) {
    ProcessLoopbackCapture* pThis = (ProcessLoopbackCapture*)param;

    // ìš°ì„ ìˆœìœ„ ìƒìŠ¹
    AvSetMmThreadCharacteristics(TEXT("Audio"), ...);

    // ìº¡ì²˜ ë£¨í”„
    while (pThis->m_state == CAPTURING) {
        // GetBuffer / Process / ReleaseBuffer
    }
}
```

**3. 3-Layer ì—ëŸ¬ ì²˜ë¦¬**

```
Layer 1: ì‚¬ìš©ì ì¹œí™”ì  enum (eCaptureError)
Layer 2: HRESULT ì €ì¥ (m_lastHResult)
Layer 3: ì—ëŸ¬ í…ìŠ¤íŠ¸ ë³€í™˜ (GetErrorText)
```

**4. ìŠ¤ë ˆë“œ ì•ˆì „ì„±**

```cpp
std::atomic<eCaptureState> m_state;  // atomic!

// Thread-safe getter
eCaptureState GetState() const {
    return m_state.load();
}
```

**5. Lock-Free Queue (ì„ íƒì )**

```cpp
moodycamel::ReaderWriterQueue<AudioChunk> m_queue;

// ì˜¤ë””ì˜¤ ìŠ¤ë ˆë“œ
m_queue.enqueue(chunk);  // Lock-free!

// Worker ìŠ¤ë ˆë“œ
if (m_queue.try_dequeue(chunk)) {
    // ëŠë¦° ì‘ì—… (ë„¤íŠ¸ì›Œí¬ ì „ì†¡ ë“±)
}
```

**ë°°ìš´ ì **:

- âœ… ë¹„ë™ê¸° COM ì‘ì—… ë™ê¸°í™” íŒ¨í„´
- âœ… ì˜¤ë””ì˜¤ ìŠ¤ë ˆë“œ ìš°ì„ ìˆœìœ„ ê´€ë¦¬
- âœ… ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€ (NULL ì²´í¬ + Release)
- âœ… OnVoice ì¬êµ¬í˜„ ì²­ì‚¬ì§„ í™•ë³´

---

### Phase 0.8: ì½˜ì†” PoC ê°œë°œ (ì™„ë£Œ) â­

- **ì‹œê°„**: T+4-6h
- **ë‚œì´ë„**: â­â­ ë³´í†µ
- **ëª©í‘œ**: PID ê¸°ë°˜ ì˜¤ë””ì˜¤ ìº¡ì²˜ ì‹¤ì œ ê²€ì¦
- **ì™„ë£Œ ë‚ ì§œ**: 2025-11-16
- **ì‹¤ì œ ì†Œìš” ì‹œê°„**: 2ì‹œê°„

**ì²´í¬í¬ì¸íŠ¸**:

- [x] Visual Studio ì½˜ì†” í”„ë¡œì íŠ¸ ìƒì„±
- [x] ProcessLoopbackCapture íŒŒì¼ ì¶”ê°€
- [x] ë§ì»¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì • (mmdevapi.lib, avrt.lib)
- [x] PID ì…ë ¥ ë° ìº¡ì²˜ í…ŒìŠ¤íŠ¸
- [x] 16kHz mono PCM ìº¡ì²˜ ê²€ì¦
- [x] ì‹¤ì‹œê°„ ë³¼ë¥¨ í‘œì‹œ (RMS ê³„ì‚°)
- [x] WAV íŒŒì¼ ì €ì¥ ê¸°ëŠ¥
- [x] Chrome í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ êµ¬í˜„
- [x] Discord í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ êµ¬í˜„

**í•µì‹¬ ì½”ë“œ**:

```cpp
// 16kHz, 16bit, Mono, PCM ì„¤ì •
capture.SetCaptureFormat(16000, 16, 1, WAVE_FORMAT_PCM);

// Chrome ë¸Œë¼ìš°ì € í”„ë¡œì„¸ìŠ¤ ìë™ ì°¾ê¸°
DWORD chromePid = FindChromeBrowserProcess();

// ìº¡ì²˜ ì‹œì‘
capture.StartCapture();

// ì½œë°±ì—ì„œ ì‹¤ì‹œê°„ ë³¼ë¥¨ ê³„ì‚°
double rms = sqrt(sum / numSamples);
int volumeBars = (int)(rms * 50);
printf("Volume: ");
for (int i = 0; i < volumeBars; i++) printf("â–ˆ");
```

**Chrome í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€**:

```cpp
// --type= í”Œë˜ê·¸ê°€ ì—†ëŠ” chrome.exe = ë¸Œë¼ìš°ì € í”„ë¡œì„¸ìŠ¤
std::wstring cmdLine = GetProcessCommandLine(pid);
if (cmdLine.find(L"--type=") == std::wstring::npos) {
    return pid;  // ë¸Œë¼ìš°ì € í”„ë¡œì„¸ìŠ¤!
}

// Fallback: ë©”ëª¨ë¦¬ ê°€ì¥ í° chrome.exe
```

**í…ŒìŠ¤íŠ¸ ê²°ê³¼**:

```
âœ… Chrome ë¸Œë¼ìš°ì € í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ ì„±ê³µ
âœ… Discord í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ ì„±ê³µ
âœ… 16kHz mono ìº¡ì²˜ ê²€ì¦ ì™„ë£Œ
âœ… íƒ€ ì•± ì†Œë¦¬ ê²©ë¦¬ í™•ì¸ (Discordë§Œ ìº¡ì²˜, Windows ì•Œë¦¼ ë¬´ì‹œ)
âœ… WAV íŒŒì¼ ì¬ìƒ í™•ì¸ (Windows Media Player)
âœ… ì´ ìº¡ì²˜ ë°ì´í„°: ~0.32 MB (10ì´ˆ)

ë³¼ë¥¨ í‘œì‹œ ì˜ˆì‹œ:
[  0.15 MB] Volume: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
[  0.31 MB] Volume: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

**ë°œê²¬í•œ ë¬¸ì œì™€ í•´ê²°**:

**ë¬¸ì œ 1**: Chrome ë©€í‹°í”„ë¡œì„¸ìŠ¤ êµ¬ì¡°

```
chrome.exe (ë¸Œë¼ìš°ì €)              â†’ ì˜¤ë””ì˜¤ ì¬ìƒ âœ…
chrome.exe --type=gpu-process      â†’ ì˜¤ë””ì˜¤ ì—†ìŒ
chrome.exe --type=renderer         â†’ ì˜¤ë””ì˜¤ ì—†ìŒ
chrome.exe --type=utility          â†’ ì˜¤ë””ì˜¤ ì—†ìŒ
```

**í•´ê²°**: ëª…ë ¹ì¤„ ì¸ìˆ˜ ë¶„ì„ìœ¼ë¡œ ë¸Œë¼ìš°ì € í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€

**ë¬¸ì œ 2**: ìˆ˜ë™ PID ì…ë ¥ ë¶ˆí¸

```
ì‚¬ìš©ì: "PIDê°€ ë­ì˜ˆìš”?"
ê°œë°œì: "Shift+ESC ëˆŒëŸ¬ì„œ..."
```

**í•´ê²°**: ìë™ í”„ë¡œì„¸ìŠ¤ ê°ì§€ êµ¬í˜„

**ë°°ìš´ ì **:

- âœ… **PID ê¸°ë°˜ ìº¡ì²˜ê°€ ì‹¤ì œë¡œ ì‘ë™í•¨** (ê°€ì¥ ì¤‘ìš”!)
- âœ… 16kHz ë³€í™˜ì´ ìë™ìœ¼ë¡œ ë¨ (SpeexDSP ë¶ˆí•„ìš”)
- âœ… ProcessLoopbackCapture API ì‚¬ìš©ë²• ì²´ë“
- âœ… Chrome ë©€í‹°í”„ë¡œì„¸ìŠ¤ ì•„í‚¤í…ì²˜ ì´í•´
- âœ… í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ ì „ëµ í™•ë¦½

---

## ğŸ“ˆ ì‹œê°„ íŠ¸ë˜í‚¹

| Phase     | ê³„íš ì‹œê°„ | ì‹¤ì œ ì‹œê°„ | ì°¨ì´      | ë¹„ê³                |
| --------- | --------- | --------- | --------- | ------------------ |
| Phase 0   | 0.5h      | 0.5h      | -         | í”„ë¡œì íŠ¸ ì´ˆê¸°í™”    |
| Phase 0.5 | -         | 1.5h      | +1.5h     | COM ê¸°ì´ˆ (ì¶”ê°€)    |
| Phase 0.6 | -         | 1h        | +1h       | WASAPI í•™ìŠµ (ì¶”ê°€) |
| Phase 0.7 | -         | 1h        | +1h       | ì½”ë“œ ë¦¬ë·° (ì¶”ê°€)   |
| Phase 0.8 | -         | 2h        | +2h       | PoC ê°œë°œ (ì¶”ê°€)    |
| **í•©ê³„**  | **0.5h**  | **6h**    | **+5.5h** | **PoC ì™„ì„±** âœ…    |

**Week 0 ì´ íˆ¬ì… ì‹œê°„**: 6ì‹œê°„  
**ë‚¨ì€ ì˜ˆìƒ ì‹œê°„**: 44ì‹œê°„ (50ì‹œê°„ - 6ì‹œê°„)

---

## ğŸ“ í•µì‹¬ í•™ìŠµ ì„±ê³¼

### ê¸°ìˆ ì  ì´í•´

**1. COM ê¸°ì´ˆ**

- âœ… IUnknown, HRESULT, ì°¸ì¡° ì¹´ìš´íŒ…
- âœ… CoInitialize/CoCreateInstance
- âœ… COM ê°ì²´ ìƒëª…ì£¼ê¸° ê´€ë¦¬

**2. WASAPI ì•„í‚¤í…ì²˜**

- âœ… 4ê°€ì§€ í•µì‹¬ ì¸í„°í˜ì´ìŠ¤ ì²´ì¸
- âœ… Loopback Capture vs ì¼ë°˜ Capture
- âœ… Process-Specific Loopback êµ¬ì¡°

**3. Windows í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬**

- âœ… CreateToolhelp32Snapshotìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ ì—´ê±°
- âœ… NtQueryInformationProcessë¡œ ëª…ë ¹ì¤„ ì½ê¸°
- âœ… PEB (Process Environment Block) ì ‘ê·¼

**4. ì˜¤ë””ì˜¤ ì²˜ë¦¬**

- âœ… PCM í¬ë§· (16bit, 16kHz, Mono)
- âœ… RMS ë³¼ë¥¨ ê³„ì‚°
- âœ… WAV íŒŒì¼ í˜•ì‹

### ì‹¤ì „ ê²½í—˜

**ê²€ì¦ ì™„ë£Œëœ ê²ƒë“¤**:

- âœ… PID ê¸°ë°˜ ì˜¤ë””ì˜¤ ìº¡ì²˜ (Discord/Chrome)
- âœ… 16kHz ìë™ ë³€í™˜ (Windows ì˜¤ë””ì˜¤ ì—”ì§„)
- âœ… ì•±ë³„ ì˜¤ë””ì˜¤ ê²©ë¦¬ (íƒ€ ì•± ì†Œë¦¬ ë¬´ì‹œ)
- âœ… ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° (ì½œë°± íŒ¨í„´)

**êµ¬í˜„ ê°€ëŠ¥í•œ ê²ƒë“¤**:

- âœ… í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ (ì‚¬ìš©ì í¸ì˜ì„±)
- âœ… ì‹¤ì‹œê°„ ë³¼ë¥¨ ëª¨ë‹ˆí„°ë§
- âœ… ì˜¤ë””ì˜¤ íŒŒì¼ ì €ì¥

---

## ğŸ¯ OnVoice ì ìš© ê³„íš

### MVP ì•„í‚¤í…ì²˜ (ìµœì¢…ì•ˆ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Electron (React.js)                â”‚
â”‚  - ì‚¬ìš©ìê°€ "Discord ê°ì§€" ì„ íƒ      â”‚
â”‚  - ì‹¤ì‹œê°„ ë³¼ë¥¨ í‘œì‹œ                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ winax (COM)
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  C++ COM DLL                        â”‚
â”‚  - FindDiscordProcess() ìë™ í˜¸ì¶œ   â”‚
â”‚  - ProcessLoopbackCapture ë˜í•‘      â”‚
â”‚  - 16kHz mono PCM ìŠ¤íŠ¸ë¦¬ë°          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ WebSocket
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FastAPI ì„œë²„                       â”‚
â”‚  - Deepgram STT                     â”‚
â”‚  - KoELECTRA ìœ í•´ í‘œí˜„ íƒì§€         â”‚
â”‚  - Volume Control ëª…ë ¹ ë°˜í™˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì¬êµ¬í˜„ vs í™œìš© ì „ëµ

**ProcessLoopbackCapture í™œìš© ë°©ì‹**:

**Phase 1-2 (Week 1)**: ë ˆí¼ëŸ°ìŠ¤ë¡œë§Œ ì‚¬ìš©

```
ëª©í‘œ: COM ë¸Œë¦¬ì§€ ê¸°ì´ˆ êµ¬ì¶•
ë°©ë²•:
1. ProcessLoopbackCapture ì½”ë“œ ì°¸ê³ 
2. OnVoiceì— í•„ìš”í•œ ê¸°ëŠ¥ë§Œ ì¶”ì¶œ
3. ì§ì ‘ ì¬êµ¬í˜„ (ë¼ì´ì„ ìŠ¤ ì•ˆì „)

ì œì™¸í•  ê¸°ëŠ¥:
- Pause/Resume (MVP ë¶ˆí•„ìš”)
- Lock-Free Queue (Phase 2ì—ì„œ)
- ë‹¤ì¤‘ í¬ë§· ì§€ì› (16kHz monoë§Œ)
```

**Phase 2 (Week 2)**: COM-Electron í†µí•©

```
ëª©í‘œ: winaxë¡œ Electron ì—°ë™
êµ¬í˜„:
1. COM ì´ë²¤íŠ¸ (IConnectionPoint)
2. SAFEARRAYë¡œ ì˜¤ë””ì˜¤ ë°ì´í„° ì „ë‹¬
3. í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ í†µí•©
```

### ê¸°ìˆ  ìŠ¤íƒ ìµœì¢… í™•ì •

**ë³€ê²½ ì‚¬í•­**:

```diff
- SpeexDSP (48kHz â†’ 16kHz ë¦¬ìƒ˜í”Œë§)
+ Windows ì˜¤ë””ì˜¤ ì—”ì§„ SRC (ìë™ ë³€í™˜)
  ì´ìœ : PoCì—ì„œ ê²€ì¦ ì™„ë£Œ, ë³µì¡ë„ ê°ì†Œ
```

**ìµœì¢… ê¸°ìˆ  ìŠ¤íƒ**:

```
C++ ë ˆì´ì–´:
- Visual Studio 2022/2026
- ATL COM In-Process DLL
- WASAPI Process Loopback
- NtQueryInformationProcess (í”„ë¡œì„¸ìŠ¤ ê°ì§€)

Electron ë ˆì´ì–´:
- winax (COM í´ë¼ì´ì–¸íŠ¸)
- Electron IPC
- React.js UI

ì„œë²„ ë ˆì´ì–´:
- FastAPI
- Deepgram STT
- KoELECTRA
```

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„: Week 1 ì‹œì‘

### Phase 1: Visual Studio 2026 + ATL ì„¤ì • (T+6-8h)

**ëª©í‘œ**: ATL í”„ë¡œì íŠ¸ í…œí”Œë¦¿ìœ¼ë¡œ "Hello COM" ë¹Œë“œ

**ì²´í¬í¬ì¸íŠ¸**:

- [ ] Visual Studio 2026 Community ì„¤ì¹˜
- [ ] Windows 10/11 SDK í™•ì¸
- [ ] ATL ì§€ì› ì„¤ì¹˜
- [ ] ATL í”„ë¡œì íŠ¸ ìƒì„±
- [ ] ë¹ˆ COM DLL ë¹Œë“œ ì„±ê³µ
- [ ] regsvr32ë¡œ DLL ë“±ë¡ í…ŒìŠ¤íŠ¸

**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 2ì‹œê°„

---

### Phase 2: C++ ê¸°ì´ˆ í•™ìŠµ (T+8-10h)

**ëª©í‘œ**: í¬ì¸í„°, ì°¸ì¡° ì´í•´

**ì²´í¬í¬ì¸íŠ¸**:

- [ ] í¬ì¸í„° ì˜ˆì œ ì‘ì„±
- [ ] ì°¸ì¡° ì˜ˆì œ ì‘ì„±
- [ ] RAII íŒ¨í„´ ì´í•´
- [ ] learning-notes.md ì—…ë°ì´íŠ¸

**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 2ì‹œê°„

---

### Phase 7: ATL COM í”„ë¡œì íŠ¸ ìƒì„± (T+10-14h)

**ê¸°ì¡´ Phase 3-6 ìŠ¤í‚µ** (PoCë¡œ ëŒ€ì²´ë¨)

**ëª©í‘œ**: OnVoice COM DLL ë¼ˆëŒ€ ì‘ì„±

**ì²´í¬í¬ì¸íŠ¸**:

- [ ] ATL í”„ë¡œì íŠ¸ "OnVoiceAudioBridge" ìƒì„±
- [ ] IOnVoiceCapture ì¸í„°í˜ì´ìŠ¤ ì •ì˜
- [ ] StartCapture(LONG pid) ë©”ì„œë“œ
- [ ] StopCapture() ë©”ì„œë“œ
- [ ] GetState() ë©”ì„œë“œ
- [ ] VBScriptë¡œ COM í˜¸ì¶œ í…ŒìŠ¤íŠ¸

**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 4ì‹œê°„

---

### Phase 8: OnVoice ìº¡ì²˜ ì—”ì§„ í†µí•© (T+14-20h)

**ëª©í‘œ**: ProcessLoopbackCapture íŒ¨í„´ ì ìš©

**ì²´í¬í¬ì¸íŠ¸**:

- [ ] ActivateAudioInterface() ì¬êµ¬í˜„
- [ ] InitializeAudioClient() ì¬êµ¬í˜„
- [ ] CaptureThread ìƒì„± ë° ê´€ë¦¬
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ì²´ê³„í™”
- [ ] FindChromeBrowserProcess() í†µí•©
- [ ] VBScriptë¡œ Discord ì˜¤ë””ì˜¤ ìº¡ì²˜ í…ŒìŠ¤íŠ¸

**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 6ì‹œê°„

---

## ğŸ“š ì°¸ê³  ìë£Œ

**ì™„ì„±ëœ ë¬¸ì„œ**:

- âœ… `docs/learning-notes.md`: COM + WASAPI ìƒì„¸ ê°œë…
- âœ… `docs/build-errors.md`: ì—ëŸ¬ í•´ê²° í…œí”Œë¦¿
- âœ… `docs/phase-progress.md`: ì´ ë¬¸ì„œ

**ë ˆí¼ëŸ°ìŠ¤ ì½”ë“œ**:

- âœ… `phase1-console/AudioCaptureTest/`: ì½˜ì†” PoC
- âœ… `phase1-console/reference/ProcessLoopbackCapture/`: ì›ë³¸ ë ˆí¬

**ì™¸ë¶€ ìë£Œ**:

- [ProcessLoopbackCapture GitHub](https://github.com/Naseband/ProcessLoopbackCapture)
- [Microsoft WASAPI ë¬¸ì„œ](https://learn.microsoft.com/en-us/windows/win32/coreaudio/wasapi)
- [ATL COM íŠœí† ë¦¬ì–¼](https://learn.microsoft.com/en-us/cpp/atl/)

---

## ğŸ‰ Week 0 ì™„ë£Œ ìš”ì•½

**ë‹¬ì„±í•œ ê²ƒ**:

- âœ… í”„ë¡œì íŠ¸ ì´ˆê¸°í™” ë° ë¬¸ì„œ êµ¬ì¡°
- âœ… COM ê¸°ì´ˆ ê°œë… í•™ìŠµ
- âœ… WASAPI ì•„í‚¤í…ì²˜ ì´í•´
- âœ… ProcessLoopbackCapture ì½”ë“œ ë¶„ì„
- âœ… **ì½˜ì†” PoC ì™„ì„± ë° ê²€ì¦** â­
- âœ… Chrome/Discord í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€
- âœ… PID ê¸°ë°˜ ì˜¤ë””ì˜¤ ìº¡ì²˜ ì‹¤ì „ ê²€ì¦

**ì‹œê°„ ì ˆê°**:

- ì›ë˜ ê³„íš: Phase 3-6 (14ì‹œê°„)
- ì‹¤ì œ ì†Œìš”: PoC (6ì‹œê°„)
- **ì ˆê°**: 8ì‹œê°„ âœ¨

**ìì‹ ê° íšë“**:

```
"PID ê¸°ë°˜ ìº¡ì²˜ê°€ ì •ë§ ë˜ëŠ”êµ¬ë‚˜!" âœ…
"16kHz ë³€í™˜ì´ ìë™ìœ¼ë¡œ ë˜ë„¤!" âœ…
"í”„ë¡œì„¸ìŠ¤ ìë™ ê°ì§€ë„ ê°€ëŠ¥í•˜êµ¬ë‚˜!" âœ…
"ì´ì œ COMìœ¼ë¡œ ê°ì‹¸ê¸°ë§Œ í•˜ë©´ ë˜ê² ë‹¤!" âœ…
```

**ë‹¤ìŒ ëª©í‘œ**: Phase 1 ì‹œì‘ (Visual Studio 2026 + ATL) ğŸš€

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-11-16  
**Week 0 ìƒíƒœ**: ì™„ë£Œ âœ…  
**ë‹¤ìŒ ë§ˆì¼ìŠ¤í†¤**: Week 1 - COM ë¸Œë¦¬ì§€ ê¸°ì´ˆ (T+6-20h)
